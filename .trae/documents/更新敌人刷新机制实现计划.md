# 更新敌人刷新机制实现计划

## 1. 更新游戏时长
- **文件**: `GameManager.ts`
- **修改**: 将`gameTime`变量从180秒（3分钟）改为600秒（10分钟）
- **代码位置**: 第35行

## 2. 更新波次配置
- **文件**: `waveConfig.json`
- **修改**: 将波次从5个扩展到20个
- **内容**: 
  - 前10波保持现有配置风格
  - 后10波适当增加难度（更多敌人、更强类型、更短间隔）
  - 可以复制前5波配置，调整参数以增加难度

## 3. 添加倒计时弹窗UI
- **文件**: `UIManager.ts`
- **修改**: 添加倒计时弹窗相关方法
- **内容**:
  - `showCountdownPopup()`: 显示倒计时弹窗
  - `hideCountdownPopup()`: 隐藏倒计时弹窗
  - `updateCountdown()`: 更新倒计时显示
  - `onCloseCountdownPopup()`: 处理关闭弹窗事件

## 4. 创建倒计时弹窗组件
- **操作**: 在场景中创建新的UI节点
- **组件**: 
  - 标题: "下一波来袭"
  - 倒计时显示: "准备时间: 01:00"
  - 提示信息: "第10-20波即将开始，准备迎战！"
  - 关闭按钮: "立即开始"
- **位置**: 屏幕右上角
- **层级**: 确保在UI最上层

## 5. 修改EnemySpawner逻辑
- **文件**: `EnemySpawner.ts`
- **修改**: 添加第10波完成后的倒计时逻辑
- **内容**:
  - 添加`isCountdownActive`状态变量
  - 添加`countdownTimer`变量，初始值60秒
  - 修改`endCurrentWave()`方法，在第10波完成时显示倒计时弹窗
  - 修改`update()`方法，处理倒计时逻辑
  - 添加`startCountdown()`方法
  - 添加`onCountdownComplete()`方法

## 6. 添加事件监听
- **文件**: `EnemySpawner.ts`
- **修改**: 监听弹窗关闭事件
- **内容**:
  - 当玩家点击关闭按钮时，调用`hideCountdownPopup()`并开始第11波

## 7. 测试验证
- **测试场景**: 运行游戏，确保
  - 游戏时长显示为10分钟
  - 前10波正常生成
  - 第10波完成后显示倒计时弹窗
  - 倒计时1分钟后自动开始第11波
  - 点击关闭按钮能立即开始第11波
  - 第11-20波正常生成
  - 敌人类型和数量符合配置

## 实现步骤
1. 首先更新`GameManager.ts`的游戏时长
2. 然后更新`waveConfig.json`的波次配置
3. 接着修改`UIManager.ts`添加弹窗相关方法
4. 在场景中创建倒计时弹窗UI
5. 最后修改`EnemySpawner.ts`实现倒计时逻辑
6. 运行游戏进行测试

所有修改都将遵循现有代码风格和架构，确保与现有系统兼容。